<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Système de Gestion de Tickets</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .ticket-priority-high {
            border-left: 4px solid #ef4444;
        }
        .ticket-priority-medium {
            border-left: 4px solid #f59e0b;
        }
        .ticket-priority-low {
            border-left: 4px solid #10b981;
        }
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }
        .slide-in {
            animation: slideIn 0.3s ease-out forwards;
        }
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
    </style>
</head>
<body class="bg-gray-100 font-sans">
    <div class="flex h-screen overflow-hidden">
        <!-- Sidebar -->
        <div class="hidden md:flex md:flex-shrink-0">
            <div class="flex flex-col w-64 bg-indigo-700 text-white">
                <div class="flex items-center justify-center h-16 px-4 bg-indigo-800">
                    <h1 class="text-xl font-bold">TicketSys</h1>
                </div>
                <div class="flex flex-col flex-grow px-4 py-4 overflow-y-auto">
                    <div class="space-y-1">
                        <button onclick="showDashboard()" class="flex items-center w-full px-4 py-2 text-sm font-medium text-white bg-indigo-800 rounded-md">
                            <i class="fas fa-tachometer-alt mr-3"></i>
                            Tableau de bord
                        </button>
                        <button onclick="showTickets()" class="flex items-center w-full px-4 py-2 text-sm font-medium text-white hover:bg-indigo-600 rounded-md">
                            <i class="fas fa-ticket-alt mr-3"></i>
                            Mes tickets
                        </button>
                        <button onclick="showNewTicketForm()" class="flex items-center w-full px-4 py-2 text-sm font-medium text-white hover:bg-indigo-600 rounded-md">
                            <i class="fas fa-plus-circle mr-3"></i>
                            Nouveau ticket
                        </button>
                        <button class="flex items-center w-full px-4 py-2 text-sm font-medium text-white hover:bg-indigo-600 rounded-md">
                            <i class="fas fa-chart-bar mr-3"></i>
                            Statistiques
                        </button>
                    </div>
                    <div class="mt-auto mb-4">
                        <div class="px-4 py-3 text-sm text-indigo-200 rounded-md bg-indigo-800">
                            <div class="flex items-center">
                                <img class="w-8 h-8 rounded-full" src="https://randomuser.me/api/portraits/women/44.jpg" alt="User avatar">
                                <div class="ml-3">
                                    <p class="font-medium">Sarah Dupont</p>
                                    <p class="text-xs">Administrateur</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main content -->
        <div class="flex flex-col flex-1 overflow-hidden">
            <!-- Top navbar -->
            <div class="flex items-center justify-between h-16 px-4 bg-white border-b border-gray-200">
                <div class="flex items-center">
                    <button class="md:hidden text-gray-500 focus:outline-none" onclick="toggleMobileMenu()">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h2 id="page-title" class="ml-4 text-lg font-semibold text-gray-800">Tableau de bord</h2>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <button class="text-gray-500 focus:outline-none">
                            <i class="fas fa-bell"></i>
                            <span class="absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full"></span>
                        </button>
                    </div>
                    <div class="relative">
                        <button class="flex items-center text-gray-500 focus:outline-none">
                            <span class="mr-2">Fr</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Mobile sidebar (hidden by default) -->
            <div id="mobile-menu" class="hidden md:hidden bg-indigo-700 text-white">
                <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                    <button onclick="showDashboard()" class="flex items-center w-full px-3 py-2 text-sm font-medium text-white bg-indigo-800 rounded-md">
                        <i class="fas fa-tachometer-alt mr-3"></i>
                        Tableau de bord
                    </button>
                    <button onclick="showTickets()" class="flex items-center w-full px-3 py-2 text-sm font-medium text-white hover:bg-indigo-600 rounded-md">
                        <i class="fas fa-ticket-alt mr-3"></i>
                        Mes tickets
                    </button>
                    <button onclick="showNewTicketForm()" class="flex items-center w-full px-3 py-2 text-sm font-medium text-white hover:bg-indigo-600 rounded-md">
                        <i class="fas fa-plus-circle mr-3"></i>
                        Nouveau ticket
                    </button>
                </div>
            </div>

            <!-- Main content area -->
            <div class="flex-1 overflow-auto p-4">
                <!-- Dashboard View -->
                <div id="dashboard-view">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                        <div class="bg-white rounded-lg shadow p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500">Tickets ouverts</p>
                                    <p class="text-2xl font-bold">24</p>
                                </div>
                                <div class="p-3 bg-blue-100 rounded-full text-blue-600">
                                    <i class="fas fa-ticket-alt"></i>
                                </div>
                            </div>
                            <div class="mt-4 text-sm text-blue-600 font-medium">
                                <span>+2 depuis hier</span>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500">En attente</p>
                                    <p class="text-2xl font-bold">8</p>
                                </div>
                                <div class="p-3 bg-yellow-100 rounded-full text-yellow-600">
                                    <i class="fas fa-clock"></i>
                                </div>
                            </div>
                            <div class="mt-4 text-sm text-yellow-600 font-medium">
                                <span>-1 depuis hier</span>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500">Résolus</p>
                                    <p class="text-2xl font-bold">42</p>
                                </div>
                                <div class="p-3 bg-green-100 rounded-full text-green-600">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                            </div>
                            <div class="mt-4 text-sm text-green-600 font-medium">
                                <span>+5 depuis hier</span>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500">Urgents</p>
                                    <p class="text-2xl font-bold">3</p>
                                </div>
                                <div class="p-3 bg-red-100 rounded-full text-red-600">
                                    <i class="fas fa-exclamation-circle"></i>
                                </div>
                            </div>
                            <div class="mt-4 text-sm text-red-600 font-medium">
                                <span>+1 depuis hier</span>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div class="lg:col-span-2 bg-white rounded-lg shadow p-6">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">Activité récente</h3>
                                <button class="text-sm text-blue-600 hover:text-blue-800">Voir tout</button>
                            </div>
                            <div class="space-y-4">
                                <div class="flex items-start">
                                    <div class="flex-shrink-0 mt-1">
                                        <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-blue-600">
                                            <i class="fas fa-ticket-alt text-sm"></i>
                                        </div>
                                    </div>
                                    <div class="ml-3">
                                        <p class="text-sm font-medium">Nouveau ticket créé</p>
                                        <p class="text-sm text-gray-500">Problème de connexion au VPN</p>
                                        <p class="text-xs text-gray-400">Il y a 2 minutes</p>
                                    </div>
                                </div>
                                <div class="flex items-start">
                                    <div class="flex-shrink-0 mt-1">
                                        <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center text-green-600">
                                            <i class="fas fa-check-circle text-sm"></i>
                                        </div>
                                    </div>
                                    <div class="ml-3">
                                        <p class="text-sm font-medium">Ticket résolu</p>
                                        <p class="text-sm text-gray-500">Imprimante en panne</p>
                                        <p class="text-xs text-gray-400">Il y a 1 heure</p>
                                    </div>
                                </div>
                                <div class="flex items-start">
                                    <div class="flex-shrink-0 mt-1">
                                        <div class="w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center text-yellow-600">
                                            <i class="fas fa-user-plus text-sm"></i>
                                        </div>
                                    </div>
                                    <div class="ml-3">
                                        <p class="text-sm font-medium">Nouvel utilisateur</p>
                                        <p class="text-sm text-gray-500">Jean Martin a rejoint l'équipe</p>
                                        <p class="text-xs text-gray-400">Il y a 3 heures</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow p-6">
                            <h3 class="text-lg font-semibold mb-4">Répartition par priorité</h3>
                            <div class="h-64">
                                <canvas id="priorityChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tickets List View -->
                <div id="tickets-view" class="hidden">
                    <div class="flex flex-col">
                        <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6">
                            <h2 class="text-2xl font-bold text-gray-800 mb-4 md:mb-0">Mes Tickets</h2>
                            <div class="flex space-x-3">
                                <div class="relative">
                                    <select id="filter-status" class="block appearance-none bg-white border border-gray-300 text-gray-700 py-2 px-4 pr-8 rounded leading-tight focus:outline-none focus:border-blue-500">
                                        <option value="all">Tous les statuts</option>
                                        <option value="open">Ouvert</option>
                                        <option value="pending">En attente</option>
                                        <option value="resolved">Résolu</option>
                                    </select>
                                    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                                        <i class="fas fa-chevron-down"></i>
                                    </div>
                                </div>
                                <div class="relative">
                                    <select id="filter-priority" class="block appearance-none bg-white border border-gray-300 text-gray-700 py-2 px-4 pr-8 rounded leading-tight focus:outline-none focus:border-blue-500">
                                        <option value="all">Toutes priorités</option>
                                        <option value="high">Haute</option>
                                        <option value="medium">Moyenne</option>
                                        <option value="low">Basse</option>
                                    </select>
                                    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                                        <i class="fas fa-chevron-down"></i>
                                    </div>
                                </div>
                                <button onclick="showNewTicketForm()" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded flex items-center">
                                    <i class="fas fa-plus mr-2"></i>
                                    Nouveau ticket
                                </button>
                            </div>
                        </div>

                        <div class="bg-white shadow rounded-lg overflow-hidden">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sujet</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Statut</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Priorité</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tickets-list" class="bg-white divide-y divide-gray-200">
                                        <!-- Tickets will be loaded here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="mt-4 flex justify-between items-center">
                            <div class="text-sm text-gray-500">
                                Affichage <span id="start-item">1</span> à <span id="end-item">10</span> sur <span id="total-items">24</span> tickets
                            </div>
                            <div class="flex space-x-1">
                                <button class="px-3 py-1 border rounded text-gray-700 bg-white hover:bg-gray-50">
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                                <button class="px-3 py-1 border rounded bg-blue-600 text-white">1</button>
                                <button class="px-3 py-1 border rounded text-gray-700 bg-white hover:bg-gray-50">2</button>
                                <button class="px-3 py-1 border rounded text-gray-700 bg-white hover:bg-gray-50">3</button>
                                <button class="px-3 py-1 border rounded text-gray-700 bg-white hover:bg-gray-50">
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- New Ticket Form -->
                <div id="new-ticket-view" class="hidden">
                    <div class="max-w-3xl mx-auto">
                        <div class="flex items-center justify-between mb-6">
                            <h2 class="text-2xl font-bold text-gray-800">Nouveau Ticket</h2>
                            <button onclick="showTickets()" class="text-gray-500 hover:text-gray-700">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>

                        <div class="bg-white shadow rounded-lg p-6">
                            <form id="ticket-form">
                                <div class="mb-6">
                                    <label for="ticket-subject" class="block text-sm font-medium text-gray-700 mb-1">Sujet</label>
                                    <input type="text" id="ticket-subject" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="Décrivez brièvement le problème">
                                </div>

                                <div class="mb-6">
                                    <label for="ticket-description" class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                                    <textarea id="ticket-description" rows="5" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="Décrivez le problème en détail..."></textarea>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                    <div>
                                        <label for="ticket-category" class="block text-sm font-medium text-gray-700 mb-1">Catégorie</label>
                                        <select id="ticket-category" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                            <option value="technical">Problème technique</option>
                                            <option value="hardware">Matériel</option>
                                            <option value="software">Logiciel</option>
                                            <option value="network">Réseau</option>
                                            <option value="other">Autre</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label for="ticket-priority" class="block text-sm font-medium text-gray-700 mb-1">Priorité</label>
                                        <select id="ticket-priority" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                            <option value="low">Basse</option>
                                            <option value="medium">Moyenne</option>
                                            <option value="high">Haute</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="mb-6">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Pièces jointes</label>
                                    <div class="border-2 border-dashed border-gray-300 rounded-md p-6 text-center">
                                        <div class="flex flex-col items-center justify-center">
                                            <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-2"></i>
                                            <p class="text-sm text-gray-600">Glissez-déposez des fichiers ici ou</p>
                                            <button type="button" class="mt-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-md text-sm font-medium">
                                                Parcourir
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="flex justify-end space-x-3">
                                    <button type="button" onclick="showTickets()" class="px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                        Annuler
                                    </button>
                                    <button type="submit" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                        Créer le ticket
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Ticket Detail View -->
                <div id="ticket-detail-view" class="hidden">
                    <div class="max-w-4xl mx-auto">
                        <div class="flex items-center justify-between mb-6">
                            <button onclick="showTickets()" class="flex items-center text-gray-600 hover:text-gray-800">
                                <i class="fas fa-arrow-left mr-2"></i>
                                Retour
                            </button>
                            <div class="flex space-x-3">
                                <button class="px-3 py-1 border rounded text-gray-700 bg-white hover:bg-gray-50 text-sm">
                                    <i class="fas fa-print mr-1"></i> Imprimer
                                </button>
                                <button class="px-3 py-1 border rounded text-gray-700 bg-white hover:bg-gray-50 text-sm">
                                    <i class="fas fa-share-alt mr-1"></i> Partager
                                </button>
                            </div>
                        </div>

                        <div class="bg-white shadow rounded-lg overflow-hidden">
                            <div id="ticket-header" class="px-6 py-4 border-b border-gray-200">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h2 id="ticket-title" class="text-xl font-bold text-gray-800">Problème de connexion au VPN</h2>
                                        <div class="flex items-center mt-2">
                                            <span id="ticket-id" class="text-sm text-gray-500 mr-4">#TKT-2023-0042</span>
                                            <span id="ticket-status" class="px-2 py-1 text-xs font-semibold rounded bg-yellow-100 text-yellow-800">En attente</span>
                                        </div>
                                    </div>
                                    <div class="flex space-x-2">
                                        <button onclick="editTicket()" class="p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-full">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-full">
                                            <i class="fas fa-trash-alt"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="px-6 py-4 border-b border-gray-200">
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <div>
                                        <p class="text-sm text-gray-500">Créé par</p>
                                        <p class="font-medium">Sarah Dupont</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-500">Assigné à</p>
                                        <p class="font-medium">Support technique</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-500">Date de création</p>
                                        <p class="font-medium">15 juin 2023, 14:30</p>
                                    </div>
                                </div>
                            </div>

                            <div class="px-6 py-4 border-b border-gray-200">
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <div>
                                        <p class="text-sm text-gray-500">Catégorie</p>
                                        <p class="font-medium">Réseau</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-500">Priorité</p>
                                        <p id="ticket-priority-display" class="font-medium">
                                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">
                                                <i class="fas fa-exclamation-circle mr-1"></i> Haute
                                            </span>
                                        </p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-500">Dernière mise à jour</p>
                                        <p class="font-medium">16 juin 2023, 09:15</p>
                                    </div>
                                </div>
                            </div>

                            <div class="px-6 py-4">
                                <h3 class="text-lg font-semibold text-gray-800 mb-3">Description</h3>
                                <div id="ticket-description-display" class="prose max-w-none text-gray-700">
                                    <p>Je n'arrive pas à me connecter au VPN depuis hier après-midi. J'obtiens systématiquement une erreur "Connexion refusée". J'ai essayé de redémarrer mon ordinateur et de réinstaller le client VPN, mais le problème persiste.</p>
                                    <p class="mt-3">Ce problème m'empêche d'accéder aux fichiers partagés sur le réseau interne, ce qui bloque mon travail actuel sur le projet X.</p>
                                </div>

                                <div class="mt-6">
                                    <h4 class="text-sm font-medium text-gray-700 mb-2">Pièces jointes</h4>
                                    <div class="flex space-x-3">
                                        <div class="flex items-center p-3 border rounded-lg bg-gray-50">
                                            <i class="fas fa-file-image text-blue-500 mr-2"></i>
                                            <div>
                                                <p class="text-sm font-medium">screenshot.png</p>
                                                <p class="text-xs text-gray-500">1.2 MB</p>
                                            </div>
                                        </div>
                                        <div class="flex items-center p-3 border rounded-lg bg-gray-50">
                                            <i class="fas fa-file-alt text-green-500 mr-2"></i>
                                            <div>
                                                <p class="text-sm font-medium">error-log.txt</p>
                                                <p class="text-xs text-gray-500">45 KB</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="border-t border-gray-200">
                                <div class="px-6 py-4">
                                    <h3 class="text-lg font-semibold text-gray-800 mb-3">Commentaires (3)</h3>
                                    <div class="space-y-4">
                                        <div class="flex">
                                            <div class="flex-shrink-0 mr-3">
                                                <img class="h-10 w-10 rounded-full" src="https://randomuser.me/api/portraits/women/44.jpg" alt="User avatar">
                                            </div>
                                            <div class="flex-1 bg-gray-50 rounded-lg px-4 py-2">
                                                <div class="flex items-center justify-between">
                                                    <p class="font-medium">Sarah Dupont</p>
                                                    <p class="text-xs text-gray-500">15 juin, 14:32</p>
                                                </div>
                                                <p class="mt-1 text-sm text-gray-700">J'ai joint une capture d'écran de l'erreur et le fichier de log.</p>
                                            </div>
                                        </div>
                                        <div class="flex">
                                            <div class="flex-shrink-0 mr-3">
                                                <img class="h-10 w-10 rounded-full" src="https://randomuser.me/api/portraits/men/32.jpg" alt="User avatar">
                                            </div>
                                            <div class="flex-1 bg-gray-50 rounded-lg px-4 py-2">
                                                <div class="flex items-center justify-between">
                                                    <p class="font-medium">Jean Martin</p>
                                                    <p class="text-xs text-gray-500">15 juin, 16:45</p>
                                                </div>
                                                <p class="mt-1 text-sm text-gray-700">Merci pour les détails. Je vois dans les logs que le problème vient de l'authentification. Pouvez-vous essayer de réinitialiser votre mot de passe VPN et me dire si ça résout le problème ?</p>
                                            </div>
                                        </div>
                                        <div class="flex">
                                            <div class="flex-shrink-0 mr-3">
                                                <img class="h-10 w-10 rounded-full" src="https://randomuser.me/api/portraits/women/44.jpg" alt="User avatar">
                                            </div>
                                            <div class="flex-1 bg-gray-50 rounded-lg px-4 py-2">
                                                <div class="flex items-center justify-between">
                                                    <p class="font-medium">Sarah Dupont</p>
                                                    <p class="text-xs text-gray-500">16 juin, 09:15</p>
                                                </div>
                                                <p class="mt-1 text-sm text-gray-700">J'ai réinitialisé le mot de passe comme suggéré, mais le problème persiste. J'obtiens maintenant une nouvelle erreur "Serveur introuvable".</p>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="mt-6">
                                        <form id="comment-form">
                                            <div class="flex">
                                                <div class="flex-shrink-0 mr-3">
                                                    <img class="h-10 w-10 rounded-full" src="https://randomuser.me/api/portraits/women/44.jpg" alt="User avatar">
                                                </div>
                                                <div class="flex-1">
                                                    <textarea rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="Ajouter un commentaire..."></textarea>
                                                    <div class="mt-2 flex justify-end">
                                                        <button type="submit" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md text-sm font-medium">
                                                            Envoyer
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Edit Ticket Form -->
                <div id="edit-ticket-view" class="hidden">
                    <div class="max-w-3xl mx-auto">
                        <div class="flex items-center justify-between mb-6">
                            <h2 class="text-2xl font-bold text-gray-800">Modifier le Ticket</h2>
                            <button onclick="showTicketDetail()" class="text-gray-500 hover:text-gray-700">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>

                        <div class="bg-white shadow rounded-lg p-6">
                            <form id="edit-ticket-form">
                                <div class="mb-6">
                                    <label for="edit-ticket-subject" class="block text-sm font-medium text-gray-700 mb-1">Sujet</label>
                                    <input type="text" id="edit-ticket-subject" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" value="Problème de connexion au VPN">
                                </div>

                                <div class="mb-6">
                                    <label for="edit-ticket-description" class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                                    <textarea id="edit-ticket-description" rows="5" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">Je n'arrive pas à me connecter au VPN depuis hier après-midi. J'obtiens systématiquement une erreur "Connexion refusée". J'ai essayé de redémarrer mon ordinateur et de réinstaller le client VPN, mais le problème persiste.

Ce problème m'empêche d'accéder aux fichiers partagés sur le réseau interne, ce qui bloque mon travail actuel sur le projet X.</textarea>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                    <div>
                                        <label for="edit-ticket-category" class="block text-sm font-medium text-gray-700 mb-1">Catégorie</label>
                                        <select id="edit-ticket-category" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                            <option value="technical">Problème technique</option>
                                            <option value="hardware">Matériel</option>
                                            <option value="software">Logiciel</option>
                                            <option value="network" selected>Réseau</option>
                                            <option value="other">Autre</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label for="edit-ticket-priority" class="block text-sm font-medium text-gray-700 mb-1">Priorité</label>
                                        <select id="edit-ticket-priority" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                            <option value="low">Basse</option>
                                            <option value="medium">Moyenne</option>
                                            <option value="high" selected>Haute</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                    <div>
                                        <label for="edit-ticket-status" class="block text-sm font-medium text-gray-700 mb-1">Statut</label>
                                        <select id="edit-ticket-status" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                            <option value="open">Ouvert</option>
                                            <option value="pending" selected>En attente</option>
                                            <option value="resolved">Résolu</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label for="edit-ticket-assignee" class="block text-sm font-medium text-gray-700 mb-1">Assigné à</label>
                                        <select id="edit-ticket-assignee" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                            <option value="support">Support technique</option>
                                            <option value="it">IT</option>
                                            <option value="network">Équipe réseau</option>
                                            <option value="admin">Administrateur</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="flex justify-end space-x-3">
                                    <button type="button" onclick="showTicketDetail()" class="px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                        Annuler
                                    </button>
                                    <button type="submit" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                        Enregistrer les modifications
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Sample ticket data
        const tickets = [
            {
                id: 'TKT-2023-0042',
                subject: 'Problème de connexion au VPN',
                description: 'Je n\'arrive pas à me connecter au VPN depuis hier après-midi. J\'obtiens systématiquement une erreur "Connexion refusée".',
                status: 'pending',
                priority: 'high',
                category: 'network',
                createdBy: 'Sarah Dupont',
                assignedTo: 'Support technique',
                createdAt: '15 juin 2023, 14:30',
                updatedAt: '16 juin 2023, 09:15',
                attachments: ['screenshot.png', 'error-log.txt'],
                comments: [
                    {
                        author: 'Sarah Dupont',
                        avatar: 'https://randomuser.me/api/portraits/women/44.jpg',
                        date: '15 juin, 14:32',
                        content: 'J\'ai joint une capture d\'écran de l\'erreur et le fichier de log.'
                    },
                    {
                        author: 'Jean Martin',
                        avatar: 'https://randomuser.me/api/portraits/men/32.jpg',
                        date: '15 juin, 16:45',
                        content: 'Merci pour les détails. Je vois dans les logs que le problème vient de l\'authentification. Pouvez-vous essayer de réinitialiser votre mot de passe VPN et me dire si ça résout le problème ?'
                    },
                    {
                        author: 'Sarah Dupont',
                        avatar: 'https://randomuser.me/api/portraits/women/44.jpg',
                        date: '16 juin, 09:15',
                        content: 'J\'ai réinitialisé le mot de passe comme suggéré, mais le problème persiste. J\'obtiens maintenant une nouvelle erreur "Serveur introuvable".'
                    }
                ]
            },
            {
                id: 'TKT-2023-0038',
                subject: 'Imprimante en panne',
                description: 'L\'imprimante du bureau ne répond plus depuis ce matin. Le voyant clignote en orange.',
                status: 'resolved',
                priority: 'medium',
                category: 'hardware',
                createdBy: 'Pierre Lefevre',
                assignedTo: 'IT',
                createdAt: '14 juin 2023, 09:15',
                updatedAt: '14 juin 2023, 11:45',
                attachments: [],
                comments: [
                    {
                        author: 'IT Support',
                        avatar: 'https://randomuser.me/api/portraits/men/45.jpg',
                        date: '14 juin, 11:30',
                        content: 'Problème résolu. Il fallait simplement remplacer la cartouche de toner.'
                    }
                ]
            },
            {
                id: 'TKT-2023-0035',
                subject: 'Mise à jour logicielle nécessaire',
                description: 'Le logiciel de comptabilité nécessite une mise à jour urgente pour être compatible avec les nouvelles réglementations.',
                status: 'open',
                priority: 'high',
                category: 'software',
                createdBy: 'Marie Dubois',
                assignedTo: 'Administrateur',
                createdAt: '13 juin 2023, 16:20',
                updatedAt: '15 juin 2023, 10:10',
                attachments: ['regulation.pdf'],
                comments: []
            },
            {
                id: 'TKT-2023-0029',
                subject: 'Accès au nouveau projet',
                description: 'Je n\'ai pas encore accès aux dossiers du nouveau projet X. Pouvez-vous vérifier mes permissions ?',
                status: 'open',
                priority: 'low',
                category: 'other',
                createdBy: 'Lucie Martin',
                assignedTo: 'Administrateur',
                createdAt: '12 juin 2023, 08:45',
                updatedAt: '12 juin 2023, 08:45',
                attachments: [],
                comments: []
            },
            {
                id: 'TKT-2023-0024',
                subject: 'Problème de souris',
                description: 'La souris sans fil ne fonctionne plus correctement. Le pointeur saute à l\'écran.',
                status: 'pending',
                priority: 'low',
                category: 'hardware',
                createdBy: 'Thomas Moreau',
                assignedTo: 'IT',
                createdAt: '10 juin 2023, 14:30',
                updatedAt: '11 juin 2023, 09:15',
                attachments: [],
                comments: [
                    {
                        author: 'IT Support',
                        avatar: 'https://randomuser.me/api/portraits/men/45.jpg',
                        date: '11 juin, 09:15',
                        content: 'Nous allons vous envoyer une nouvelle souris. En attendant, pouvez-vous essayer avec une souris filaire ?'
                    }
                ]
            }
        ];

        // DOM elements
        const dashboardView = document.getElementById('dashboard-view');
        const ticketsView = document.getElementById('tickets-view');
        const newTicketView = document.getElementById('new-ticket-view');
        const ticketDetailView = document.getElementById('ticket-detail-view');
        const editTicketView = document.getElementById('edit-ticket-view');
        const ticketsList = document.getElementById('tickets-list');
        const filterStatus = document.getElementById('filter-status');
        const filterPriority = document.getElementById('filter-priority');
        const pageTitle = document.getElementById('page-title');

        // Current selected ticket
        let currentTicket = null;

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            loadTickets();
            initPriorityChart();
            
            // Form submissions
            document.getElementById('ticket-form').addEventListener('submit', createTicket);
            document.getElementById('edit-ticket-form').addEventListener('submit', updateTicket);
            document.getElementById('comment-form').addEventListener('submit', addComment);
            
            // Filter changes
            filterStatus.addEventListener('change', filterTickets);
            filterPriority.addEventListener('change', filterTickets);
        });

        // View navigation functions
        function showDashboard() {
            dashboardView.classList.remove('hidden');
            ticketsView.classList.add('hidden');
            newTicketView.classList.add('hidden');
            ticketDetailView.classList.add('hidden');
            editTicketView.classList.add('hidden');
            pageTitle.textContent = 'Tableau de bord';
        }

        function showTickets() {
            dashboardView.classList.add('hidden');
            ticketsView.classList.remove('hidden');
            newTicketView.classList.add('hidden');
            ticketDetailView.classList.add('hidden');
            editTicketView.classList.add('hidden');
            pageTitle.textContent = 'Mes Tickets';
            loadTickets();
        }

        function showNewTicketForm() {
            dashboardView.classList.add('hidden');
            ticketsView.classList.add('hidden');
            newTicketView.classList.remove('hidden');
            ticketDetailView.classList.add('hidden');
            editTicketView.classList.add('hidden');
            pageTitle.textContent = 'Nouveau Ticket';
        }

        function showTicketDetail(ticketId = null) {
            if (ticketId) {
                currentTicket = tickets.find(t => t.id === ticketId);
            }
            
            if (currentTicket) {
                document.getElementById('ticket-title').textContent = currentTicket.subject;
                document.getElementById('ticket-id').textContent = `#${currentTicket.id}`;
                document.getElementById('ticket-description-display').innerHTML = `<p>${currentTicket.description.replace(/\n/g, '</p><p>')}</p>`;
                
                // Set status
                const statusElement = document.getElementById('ticket-status');
                statusElement.textContent = getStatusText(currentTicket.status);
                statusElement.className = 'px-2 py-1 text-xs font-semibold rounded ' + getStatusClass(currentTicket.status);
                
                // Set priority
                const priorityElement = document.getElementById('ticket-priority-display');
                priorityElement.innerHTML = getPriorityBadge(currentTicket.priority);
            }
            
            dashboardView.classList.add('hidden');
            ticketsView.classList.add('hidden');
            newTicketView.classList.add('hidden');
            ticketDetailView.classList.remove('hidden');
            editTicketView.classList.add('hidden');
            pageTitle.textContent = 'Détails du Ticket';
        }

        function editTicket() {
            if (currentTicket) {
                document.getElementById('edit-ticket-subject').value = currentTicket.subject;
                document.getElementById('edit-ticket-description').value = currentTicket.description;
                document.getElementById('edit-ticket-category').value = currentTicket.category;
                document.getElementById('edit-ticket-priority').value = currentTicket.priority;
                document.getElementById('edit-ticket-status').value = currentTicket.status;
                document.getElementById('edit-ticket-assignee').value = currentTicket.assignedTo.toLowerCase().replace(' ', '-');
            }
            
            ticketDetailView.classList.add('hidden');
            editTicketView.classList.remove('hidden');
            pageTitle.textContent = 'Modifier le Ticket';
        }

        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenu.classList.toggle('hidden');
        }

        // Ticket functions
        function loadTickets() {
            ticketsList.innerHTML = '';
            
            tickets.forEach(ticket => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50';
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${ticket.id}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        <button onclick="showTicketDetail('${ticket.id}')" class="text-blue-600 hover:text-blue-800">${ticket.subject}</button>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 py-1 text-xs font-semibold rounded ${getStatusClass(ticket.status)}">${getStatusText(ticket.status)}</span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        ${getPriorityBadge(ticket.priority)}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${ticket.createdAt}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="showTicketDetail('${ticket.id}')" class="text-blue-600 hover:text-blue-900 mr-3"><i class="fas fa-eye"></i></button>
                        <button class="text-gray-600 hover:text-gray-900"><i class="fas fa-ellipsis-v"></i></button>
                    </td>
                `;
                ticketsList.appendChild(row);
            });
        }

        function filterTickets() {
            const statusFilter = filterStatus.value;
            const priorityFilter = filterPriority.value;
            
            const filteredTickets = tickets.filter(ticket => {
                const statusMatch = statusFilter === 'all' || ticket.status === statusFilter;
                const priorityMatch = priorityFilter === 'all' || ticket.priority === priorityFilter;
                return statusMatch && priorityMatch;
            });
            
            // Update the tickets list with filtered results
            ticketsList.innerHTML = '';
            filteredTickets.forEach(ticket => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50';
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${ticket.id}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        <button onclick="showTicketDetail('${ticket.id}')" class="text-blue-600 hover:text-blue-800">${ticket.subject}</button>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 py-1 text-xs font-semibold rounded ${getStatusClass(ticket.status)}">${getStatusText(ticket.status)}</span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        ${getPriorityBadge(ticket.priority)}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${ticket.createdAt}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="showTicketDetail('${ticket.id}')" class="text-blue-600 hover:text-blue-900 mr-3"><i class="fas fa-eye"></i></button>
                        <button class="text-gray-600 hover:text-gray-900"><i class="fas fa-ellipsis-v"></i></button>
                    </td>
                `;
                ticketsList.appendChild(row);
            });
        }

        function createTicket(e) {
            e.preventDefault();
            
            const subject = document.getElementById('ticket-subject').value;
            const description = document.getElementById('ticket-description').value;
            const category = document.getElementById('ticket-category').value;
            const priority = document.getElementById('ticket-priority').value;
            
            // Generate a new ticket ID
            const newId = `TKT-2023-${String(tickets.length + 1).padStart(4, '0')}`;
            
            const newTicket = {
                id: newId,
                subject,
                description,
                status: 'open',
                priority,
                category,
                createdBy: 'Sarah Dupont',
                assignedTo: 'Support technique',
                createdAt: new Date().toLocaleDateString('fr-FR', { day: 'numeric', month: 'long', year: 'numeric', hour: '2-digit', minute: '2-digit' }),
                updatedAt: new Date().toLocaleDateString('fr-FR', { day: 'numeric', month: 'long', year: 'numeric', hour: '2-digit', minute: '2-digit' }),
                attachments: [],
                comments: []
            };
            
            tickets.unshift(newTicket);
            
            // Reset form
            document.getElementById('ticket-form').reset();
            
            // Show the new ticket
            currentTicket = newTicket;
            showTicketDetail();
            
            // Show success message
            alert('Ticket créé avec succès!');
        }

        function updateTicket(e) {
            e.preventDefault();
            
            if (currentTicket) {
                currentTicket.subject = document.getElementById('edit-ticket-subject').value;
                currentTicket.description = document.getElementById('edit-ticket-description').value;
                currentTicket.category = document.getElementById('edit-ticket-category').value;
                currentTicket.priority = document.getElementById('edit-ticket-priority').value;
                currentTicket.status = document.getElementById('edit-ticket-status').value;
                currentTicket.assignedTo = document.getElementById('edit-ticket-assignee').value;
                currentTicket.updatedAt = new Date().toLocaleDateString('fr-FR', { day: 'numeric', month: 'long', year: 'numeric', hour: '2-digit', minute: '2-digit' });
                
                // Show the updated ticket
                showTicketDetail();
                
                // Show success message
                alert('Ticket mis à jour avec succès!');
            }
        }

        function addComment(e) {
            e.preventDefault();
            
            if (currentTicket) {
                const commentInput = document.querySelector('#comment-form textarea');
                const commentText = commentInput.value.trim();
                
                if (commentText) {
                    const newComment = {
                        author: 'Sarah Dupont',
                        avatar: 'https://randomuser.me/api/portraits/women/44.jpg',
                        date: new Date().toLocaleDateString('fr-FR', { day: 'numeric', month: 'long', hour: '2-digit', minute: '2-digit' }),
                        content: commentText
                    };
                    
                    currentTicket.comments.push(newComment);
                    currentTicket.updatedAt = new Date().toLocaleDateString('fr-FR', { day: 'numeric', month: 'long', year: 'numeric', hour: '2-digit', minute: '2-digit' });
                    
                    // Reset form
                    commentInput.value = '';
                    
                    // Reload the ticket view to show the new comment
                    showTicketDetail();
                }
            }
        }

        // Helper functions
        function getStatusText(status) {
            const statusMap = {
                'open': 'Ouvert',
                'pending': 'En attente',
                'resolved': 'Résolu'
            };
            return statusMap[status] || status;
        }

        function getStatusClass(status) {
            const classMap = {
                'open': 'bg-blue-100 text-blue-800',
                'pending': 'bg-yellow-100 text-yellow-800',
                'resolved': 'bg-green-100 text-green-800'
            };
            return classMap[status] || 'bg-gray-100 text-gray-800';
        }

        function getPriorityText(priority) {
            const priorityMap = {
                'high': 'Haute',
                'medium': 'Moyenne',
                'low': 'Basse'
            };
            return priorityMap[priority] || priority;
        }

        function getPriorityBadge(priority) {
            const badgeMap = {
                'high': '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"><i class="fas fa-exclamation-circle mr-1"></i> Haute</span>',
                'medium': '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800"><i class="fas fa-exclamation-triangle mr-1"></i> Moyenne</span>',
                'low': '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"><i class="fas fa-info-circle mr-1"></i> Basse</span>'
            };
            return badgeMap[priority] || '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800">Inconnue</span>';
        }

        function initPriorityChart() {
            const ctx = document.getElementById('priorityChart').getContext('2d');
            
            // Count tickets by priority
            const priorityCounts = {
                high: tickets.filter(t => t.priority === 'high').length,
                medium: tickets.filter(t => t.priority === 'medium').length,
                low: tickets.filter(t => t.priority === 'low').length
            };
            
            const chart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Haute', 'Moyenne', 'Basse'],
                    datasets: [{
                        data: [priorityCounts.high, priorityCounts.medium, priorityCounts.low],
                        backgroundColor: [
                            '#ef4444',
                            '#f59e0b',
                            '#10b981'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                padding: 20
                            }
                        }
                    },
                    cutout: '70%'
                }
            });
        }
    </script>
</body>
</html>
